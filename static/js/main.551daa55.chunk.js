(this["webpackJsonpcoronavirus-map-client"]=this["webpackJsonpcoronavirus-map-client"]||[]).push([[0],{103:function(t,a,e){},105:function(t,a,e){},109:function(t,a,e){},110:function(t,a,e){},112:function(t,a,e){"use strict";e.r(a);var r=e(1),n=e.n(r),i=e(61),o=e.n(i),l=(e(103),e(15)),s=e.n(l),c=e(63),d=e(62),u=e(3),h=e(4),p=e(13),f=e(12),b=e(6),v=e(14),g=e(0),m=(e(105),e(5)),y=function(){function t(a){Object(u.a)(this,t),this.basicMapProps=void 0,this.pathGenerator=void 0,this.defaultStrokeWidth="0.01px",this.coloredStrokeWidth="0.1px",this.tooltipHide=function(t){t.style("opacity",0)},this.tooltipShow=function(t,a){var e;t.transition().style("opacity",1),e=Object(m.isNullOrUndefined)(a.infected)?a.properties.name:"".concat(a.countryGeo.properties.name,": ").concat(a.infected),t.style("left",g.c.pageX+"px").style("top",g.c.pageY+"px").text(e)},this.basicMapProps=a,this.renderBasicMap(this.basicMapProps)}return Object(h.a)(t,[{key:"renderTooltip",value:function(t){var a=this,e=this.basicMapProps.tooltip;t.on("click",(function(t){a.tooltipShow(e,t)})).on("mouseover",(function(t){a.tooltipShow(e,t)})).on("mouseout",(function(t){a.tooltipHide(e)}))}},{key:"coloringMap",value:function(t,a){var e=this,r=this.basicMapProps.selector.selectAll(".country").data(a,(function(t){return t.countryId})).join("path").attr("class","country").attr("d",(function(t){return e.pathGenerator(t.countryGeo)})).attr("fill",(function(a){return t(a.infected)})).attr("stroke-width",(function(t){return 0===t.infected?e.defaultStrokeWidth:e.coloredStrokeWidth}));this.renderTooltip(r)}},{key:"hilightingMap",value:function(t){this.basicMapProps.selector.selectAll(".country").attr("opacity",(function(a){return null===t||a.infected>=t[0]&&a.infected<=t[1]?1:.2}))}},{key:"renderBasicMap",value:function(t){var a=t.selector,e=t.projection,r=t.worldGeo,n=t.countryColor,i=t.sphereColor,o=g.f(e);this.pathGenerator=o;var l=a;l.selectAll(".sphere").data([null]).join("path").attr("class","sphere").attr("d",(function(t){return o({type:"Sphere"})})).attr("fill",i);var s=l.selectAll(".country").data(r,(function(t){return t.id})).join("path").attr("class","country").attr("d",(function(t){return o(t)})).attr("fill",n).attr("stroke-width",this.defaultStrokeWidth);return this.renderTooltip(s),l}}]),t}(),S={Afghanistan:"004",Albania:"008",Algeria:"012",Andorra:"020",Angola:"024",Anguilla:"660","Antigua and Barbuda":"028",Argentina:"032",Armenia:"051",Aruba:"533",Australia:"036",Austria:"040",Azerbaijan:"031",Bahamas:"044",Bahrain:"048",Bangladesh:"050",Barbados:"052",Belarus:"112",Belgium:"056",Belize:"084",Benin:"204",Bermuda:"060",Bhutan:"064",Bolivia:"068","Bonaire Sint Eustatius and Saba":null,"Bosnia and Herzegovina":"070",Botswana:"072",Brazil:"076","British Virgin Islands":"092",Brunei:"096",Bulgaria:"100","Burkina Faso":"854",Burundi:"108",Cambodia:"116",Cameroon:"120",Canada:"124","Cape Verde":"132","Cayman Islands":"136","Central African Republic":"140",Chad:"148",Chile:"152",China:"156",Colombia:"170",Congo:"178","Costa Rica":"188","Cote d'Ivoire":"384",Croatia:"191",Cuba:"192",Curacao:"531",Cyprus:"196","Czech Republic":"203","Democratic Republic of Congo":"180",Denmark:"208",Djibouti:"262",Dominica:"212","Dominican Republic":"214",Ecuador:"218",Egypt:"818","El Salvador":"222","Equatorial Guinea":"226",Eritrea:"232",Estonia:"233",Ethiopia:"231","Faeroe Islands":"234","Falkland Islands":"238",Fiji:"242",Finland:"246",France:"250","French Polynesia":"258",Gabon:"266",Gambia:"270",Georgia:"268",Germany:"276",Ghana:"288",Gibraltar:null,Greece:"300",Greenland:"304",Grenada:"308",Guam:"316",Guatemala:"320",Guernsey:"831",Guinea:"324","Guinea-Bissau":"624",Guyana:"328",Haiti:"332",Honduras:"340",Hungary:"348",Iceland:"352",India:"356",Indonesia:"360",Iran:"364",Iraq:"368",Ireland:"372","Isle of Man":"833",Israel:"376",Italy:"380",Jamaica:"388",Japan:"392",Jersey:"832",Jordan:"400",Kazakhstan:"398",Kenya:"404",Kosovo:null,Kuwait:"414",Kyrgyzstan:"417",Laos:"418",Latvia:"428",Lebanon:"422",Liberia:"430",Libya:"434",Liechtenstein:"438",Lithuania:"440",Luxembourg:"442",Macedonia:"807",Madagascar:"450",Malawi:"454",Malaysia:"458",Maldives:"462",Mali:"466",Malta:"470",Mauritania:"478",Mauritius:"480",Mexico:"484",Moldova:"498",Monaco:"492",Mongolia:"496",Montenegro:"499",Montserrat:"500",Morocco:"504",Mozambique:"508",Myanmar:"104",Namibia:"516",Nepal:"524",Netherlands:"528","New Caledonia":"540","New Zealand":"554",Nicaragua:"558",Niger:"562",Nigeria:"566","Northern Mariana Islands":"580",Norway:"578",Oman:"512",Pakistan:"586",Palestine:"275",Panama:"591","Papua New Guinea":"598",Paraguay:"600",Peru:"604",Philippines:"608",Poland:"616",Portugal:"620","Puerto Rico":"630",Qatar:"634",Romania:"642",Russia:"643",Rwanda:"646","Saint Kitts and Nevis":"659","Saint Lucia":"662","Saint Vincent and the Grenadines":"670","San Marino":"674","Sao Tome and Principe":"678","Saudi Arabia":"682",Senegal:"686",Serbia:"688",Seychelles:"690","Sierra Leone":"694",Singapore:"702","Sint Maarten (Dutch part)":"534",Slovakia:"703",Slovenia:"705",Somalia:"706","South Africa":"710","South Korea":"410","South Sudan":"728",Spain:"724","Sri Lanka":"144",Sudan:"729",Suriname:"740",Swaziland:"748",Sweden:"752",Switzerland:"756",Syria:"760",Taiwan:"158",Tanzania:"834",Thailand:"764",Timor:"626",Togo:"768","Trinidad and Tobago":"780",Tunisia:"788",Turkey:"792","Turks and Caicos Islands":"796",Uganda:"800",Ukraine:"804","United Arab Emirates":"784","United Kingdom":"826","United States":"840","United States Virgin Islands":"850",Uruguay:"858",Uzbekistan:"860",Vatican:"336",Venezuela:"862",Vietnam:"704",Yemen:"887",Zambia:"894",Zimbabwe:"716","Western Sahara":"732","French Southern and Antarctic Lands":"260",Lesotho:"426",Vanuatu:"548","North Korea":"408",Tajikistan:"762",Turkmenistan:"795","Solomon Island":"090",Antarctica:"010",Micronesia:"583","Marshall Is.":"584","American Samoa":"016","S. Geo. and the Is.":"239","Br. Indian Ocean Ter.":"086","Saint Helena":"654","Pitcairn Is.":"612",Tonga:"776",Samoa:"882",Palau:"585",Niue:"570","Cook Is.":"184",Kiribati:"296","St. Pierre and Miquelon":"666","Wallis and Futuna Is.":"876","St-Martin":"663","St-Barth\xe9lemy":"652","\xc5land":"248",Comoros:"174",Macao:"446","Hong Kong":"344","Heard I. and McDonald Is.":"334","Norfolk Island":"574"};e(109);var k=g.m("%d %b"),x=function(t){function a(t){var e;Object(u.a)(this,a),(e=Object(p.a)(this,Object(f.a)(a).call(this,t))).timeScale=void 0,e.handle=void 0,e.handleText=void 0,e.playInterWidth=void 0,e.cursorMoving=!1,e.buttonTimer=void 0,e.currentCursorWidth=0,e.buttonPlayColor="#cb1c1ede",e.buttonPauseColor="#696969",e.initDateSlider.bind(Object(b.a)(e)),e.updateDateSlider.bind(Object(b.a)(e));var r=g.k().domain([e.props.startDate,e.props.endDate]).range([0,e.props.sliderWidth]).clamp(!0);return e.timeScale=r,e}return Object(v.a)(a,t),Object(h.a)(a,[{key:"componentDidMount",value:function(){var t=this,a=this.props.selector.selectAll(".button").data([null]).join("g").attr("class","button");a.selectAll("rect").data([null]).join("rect").attr("height","50").attr("width","120").attr("x","0").attr("y","0").attr("rx","10").attr("transform","translate(-150, -30)").attr("fill",this.buttonPlayColor),a.selectAll("text").data([null]).join("text").attr("fill","white").attr("transform","translate(-90, 5)").style("text-anchor","middle").text("Play"),a.on("mouseover",(function(){a.select("rect").transition().attr("fill",t.buttonPauseColor)})).on("mouseout",(function(){"Play"===a.text()&&a.select("rect").transition().attr("fill",t.buttonPlayColor)})),a.on("click",(function(){"Pause"===a.text()?(t.cursorMoving=!1,clearInterval(t.buttonTimer),a.select("rect").transition().attr("fill",t.buttonPlayColor),a.select("text").transition().text("Play")):(t.cursorMoving=!0,t.buttonTimer=setInterval(e,100),a.select("rect").transition().attr("fill",t.buttonPauseColor),a.select("text").transition().text("Pause"))}));var e=function(){t.updateDateSlider(t.timeScale.invert(t.currentCursorWidth)),t.currentCursorWidth+=t.playInterWidth,t.currentCursorWidth>t.props.sliderWidth+t.playInterWidth&&(t.cursorMoving=!1,t.currentCursorWidth=0,clearInterval(t.buttonTimer),a.select("rect").transition().attr("fill",t.buttonPlayColor),a.select("text").transition().text("Play"))};this.initDateSlider()}},{key:"updateDateSlider",value:function(t){this.handle.attr("cx",this.timeScale(t)),this.handleText.attr("x",this.timeScale(t)).text(k(t)),this.props.onSliderDragged(t)}},{key:"initDateSlider",value:function(){var t=this,a=this.props.selector;a.selectAll(".track").data([null]).join("line").attr("class","track"),a.selectAll(".track-inset").data([null]).join("line").attr("class","track-inset");var e=a.selectAll(".track-overlay").data([null]).join("line").attr("class","track-overlay");a.selectAll("line").attr("x1",this.timeScale.range()[0]).attr("x2",this.timeScale.range()[1]),e.call(g.b().on("start.interrupt",(function(){return a.interrupt()})).on("start drag",(function(){t.currentCursorWidth=g.c.x,t.updateDateSlider(t.timeScale.invert(t.currentCursorWidth))})));var r=Math.floor((this.props.endDate.getTime()-this.props.startDate.getTime())/864e5),n=Math.floor(r/7),i=n>15?15:n;this.playInterWidth=this.props.sliderWidth/(r+1),a.insert("g",".track-overlay").attr("class","ticks").attr("transform","translate(0, ".concat(this.props.tickOffset,")")).selectAll("text").data(this.timeScale.ticks(i)).join("text").attr("x",this.timeScale).attr("y",10).attr("text-anchor","middle").text((function(t){return k(t)})),this.handle=a.insert("circle",".track-overlay").attr("class","handle").attr("r",this.props.handleRadius).attr("cx",this.timeScale(this.props.endDate)),this.handleText=a.append("text").attr("class","handleText").attr("text-anchor","middle").attr("x",this.timeScale(this.props.endDate)).text(k(this.props.endDate)).attr("transform","translate(0, ".concat(this.props.handleTextOffset,")"))}},{key:"render",value:function(){return n.a.createElement("div",{id:"DateSlider"})}}]),a}(r.Component),M=g.d(",d"),j=function(){function t(a){Object(u.a)(this,t),this.props=void 0,this.backgroundWidth=160,this.backgroundHeight=250,this.barMargin={top:25,left:15},this.barWidth=30,this.barHeight=200,this.fontsize=18,this.colorLegendVerticalG=void 0,this.props=a,this.colorLegendVerticalG=this.props.selector.selectAll("#ColorLegendVertical").data([1]).join("g").attr("id","ColorLegendVertical"),this.background(),this.clickableLegend(this.props.clickedDomain)}return Object(h.a)(t,[{key:"background",value:function(){this.colorLegendVerticalG.selectAll("rect").data([null]).join("rect").attr("height",this.backgroundHeight).attr("width",this.backgroundWidth).attr("x","1").attr("fill","white").attr("opacity","0.7").attr("ry",10)}},{key:"gradientLegend",value:function(){for(var t=this.props.colorScaleMax,a=this.props.colorScale,e=[],r=t/10,n=0;n<10;++n){var i=0+r*n;e.push({number:i,offset:"".concat(i/t*100,"%"),color:a(i)})}this.colorLegendVerticalG.selectAll("defs").data([null]).join("defs").selectAll("linearGradient").data([null]).join("linearGradient").attr("id","svgGradient").attr("x1","0%").attr("x2","0%").attr("y1","0%").attr("y2","100%").selectAll("stop").data(e).join("stop").attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color}));this.colorLegendVerticalG.selectAll(".gradient-rect").data([null]).join("rect").attr("class","gradient-rect").attr("fill","url(#svgGradient)").attr("transform","translate(".concat(this.barMargin.left,", ").concat(this.barMargin.top,")")).attr("width",this.barWidth).attr("height",this.barHeight);this.colorLegendVerticalG.selectAll(".text0").data(["0"]).join("text").attr("class","text0").attr("text-anchor","middle").text((function(t){return t})).attr("font-size",this.fontsize).attr("x",this.barWidth/2+this.barMargin.left).attr("y",.75*this.barMargin.top),this.colorLegendVerticalG.selectAll(".textMax").data([">".concat(M(t))]).join("text").attr("class","textMax").attr("text-anchor","middle").text((function(t){return t})).attr("font-size",this.fontsize).attr("x",this.barWidth/2+this.barMargin.left+this.fontsize/2).attr("y",this.barMargin.top+this.barHeight+this.fontsize)}},{key:"clickableLegend",value:function(t){var a=this,e=this.props.colorScaleMax,r=this.colorLegendVerticalG.selectAll(".clickable").data([null]).join("g").attr("class","clickable"),n=[[1,9],[10,99],[100,999],[1e3,4999],[5e3,9999],[1e4,49999],[5e4,e-1],[e,753e7]],i=(this.backgroundHeight-this.fontsize)/n.length,o=r.selectAll(".clickable-ticks").data(n).join("g").attr("class","clickable-ticks").attr("transform",(function(t,e){return"translate(".concat(a.fontsize,", ").concat(a.fontsize+i*e,")")})).attr("cursor","pointer").attr("opacity",(function(a){return!t||a[0]===t[0]&&a[1]===t[1]?1:.2})).on("click",(function(e){return a.props.onClick(t&&e[0]===t[0]&&e[1]===t[1]?null:e)}));o.selectAll("rect").data((function(t){return[t]})).join("rect").attr("fill",(function(t){return a.props.colorScale(t[0])})).attr("ry",5).attr("width",20).attr("height",20),o.selectAll("text").data((function(t){return[t]})).join("text").attr("font-size",this.fontsize).attr("text-anchor","left").attr("dominant-baseline","hanging").attr("transform","translate(".concat(24,", 0)")).text((function(t){return t[0]===e?">".concat(M(e)):"".concat(M(t[0]),"-").concat(M(t[1]))}))}}]),t}(),C=(e(110),e(111)),w=function(t){function a(){var t;return Object(u.a)(this,a),(t=Object(p.a)(this,Object(f.a)(a).call(this,{}))).state={sliderProps:void 0},t.dataDownloaded=!1,t.worldGeo=void 0,t.worldCovid=new Map,t.startDate=void 0,t.endDate=void 0,t.colorScaleMax=1e5,t.colorScale=void 0,t.coloredMap=void 0,t.colorNonInfacted="#ffffff",t.sphereColor="#3bb9b99a",t.drawBasicMapSVG.bind(Object(b.a)(t)),t.getWorldData(),t}return Object(v.a)(a,t),Object(h.a)(a,[{key:"constructWorldCovidKey",value:function(t){return"".concat(t.getUTCDate(),"/").concat(t.getUTCMonth()+1)}},{key:"getWorldData",value:function(){var t=Object(d.a)(s.a.mark((function t(){var a,e,r,n,i,o,l,d,u,h,p,f,b;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([g.h("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-50m.json"),g.a("https://covid.ourworldindata.org/data/ecdc/total_cases.csv")]);case 2:a=t.sent,e=Object(c.a)(a,2),r=e[0],n=e[1],this.worldGeo=C.feature(r,r.objects.countries).features,n.sort((function(t,a){var e=new Date(t.date),r=new Date(a.date);return e.getTime()-r.getTime()})),this.startDate=new Date(n[0].date),this.endDate=new Date(n[n.length-1].date),i=null,o=!0,l=!1,d=void 0,t.prev=14,u=n[Symbol.iterator]();case 16:if(o=(h=u.next()).done){t.next=34;break}p=h.value,t.t0=s.a.keys(p);case 19:if((t.t1=t.t0()).done){t.next=28;break}if(f=t.t1.value,!Object.prototype.hasOwnProperty.call(p,f)){t.next=26;break}if("date"!==f){t.next=24;break}return t.abrupt("continue",19);case 24:""===p[f]&&(p[f]=null===i?0:i[f]);case 26:t.next=19;break;case 28:b=new Date(p.date),this.worldCovid.set(this.constructWorldCovidKey(b),p),i=p;case 31:o=!0,t.next=16;break;case 34:t.next=40;break;case 36:t.prev=36,t.t2=t.catch(14),l=!0,d=t.t2;case 40:t.prev=40,t.prev=41,o||null==u.return||u.return();case 43:if(t.prev=43,!l){t.next=46;break}throw d;case 46:return t.finish(43);case 47:return t.finish(40);case 48:this.dataDownloaded=!0,this.colorScale=this.createColorScale(),this.drawBasicMapSVG();case 51:case"end":return t.stop()}}),t,this,[[14,36,40,48],[41,,43,47]])})));return function(){return t.apply(this,arguments)}}()},{key:"createColorScale",value:function(){var t=this,a=this.colorScaleMax,e=g.i().domain([1,a]);return g.j((function(r){return 0===r?t.colorNonInfacted:r>=a?"#4d0000":g.g(e(r))}))}},{key:"drawBasicMapSVG",value:function(){if(!Object(m.isNullOrUndefined)(this.dataDownloaded)){var t=g.l("#CovidMap").selectAll(".svg-container").data([null]).join("div").classed("svg-container",!0).selectAll("svg").data([null]).join("svg").classed("svg-content-responsive",!0).attr("viewBox","0 0 ".concat(1024," ").concat(768)).attr("preserveAspectRatio","xMinYMin meet"),a=t.selectAll(".zoom-container").data([null]).join("g").attr("class","zoom-container");a.selectAll(".title").data([null]).join("text").attr("class","title").text("COVID-19 Outbreak Across the World").attr("font-size","1.5em").attr("font-family","sans-serif").attr("transform","translate(270, 50)");var e=g.l("#CovidMap").selectAll(".country-tooltip").data([null]).join("div").attr("class","country-tooltip").style("opacity",0),r={selector:a.selectAll(".map").data([null]).join("g").attr("class","map"),projection:g.e().scale(125),worldGeo:this.worldGeo,countryColor:this.colorNonInfacted,sphereColor:this.sphereColor,tooltip:e},n=new y(r);this.coloredMap=n;var i,o=a.selectAll(".colorLegend").data([null]).join("g").attr("class","colorLegend").attr("transform","translate(210, 260) scale(0.5, 0.5)"),l=new j({selector:o,colorScale:this.colorScale,colorScaleMax:this.colorScaleMax,onClick:function(t){i=t,n.hilightingMap(i),l.clickableLegend(i)},clickedDomain:i}),s={selector:a.selectAll(".slider").data([null]).join("g").attr("class","slider").attr("transform","translate(200, 450) scale(0.5, 0.5)"),startDate:this.startDate,endDate:this.endDate,sliderWidth:1200,tickOffset:10,handleRadius:10,handleTextOffset:-20,onSliderDragged:this.colorMapByDay.bind(this)};this.colorMapByDay(this.endDate);var c=g.n().scaleExtent([1,8]).on("zoom",(function(){a.attr("transform",g.c.transform)}));t.call(c),this.setState({sliderProps:s})}}},{key:"colorMapByDay",value:function(t){var a=this.worldCovid.get(this.constructWorldCovidKey(t));if(!Object(m.isNullOrUndefined)(a)){var e=this.combineWordGeoAndCovid(this.worldGeo,a);this.coloredMap.coloringMap(this.colorScale,e)}}},{key:"combineWordGeoAndCovid",value:function(t,a){var e=new Map;return t.forEach((function(t){e.set(t.id,{countryId:t.id,countryGeo:t,infected:0})})),Object.keys(a).forEach((function(t){var r=S[t];if(!Object(m.isNullOrUndefined)(r)){var n=e.get(r);Object(m.isNullOrUndefined)(n)||(n.infected=Number(a[t]),e.set(r,n))}})),Array.from(e.values())}},{key:"render",value:function(){if(!Object(m.isNullOrUndefined)(this.state.sliderProps)){var t=this.state.sliderProps;return n.a.createElement("div",{id:"CovidMap"},n.a.createElement(x,t))}return n.a.createElement("div",{id:"CovidMap"})}}]),a}(r.Component);o.a.render(n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"container"},n.a.createElement(w,null))),document.getElementById("root"))},98:function(t,a,e){t.exports=e(112)}},[[98,1,2]]]);
//# sourceMappingURL=main.551daa55.chunk.js.map